<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <configSections>
    <section name="episerver.search.indexingservice" type="EPiServer.Search.IndexingService.Configuration.IndexingServiceSection, EPiServer.Search.IndexingService" />
    <section name="episerver.framework" type="EPiServer.Framework.Configuration.EPiServerFrameworkSection, EPiServer.Framework.AspNet" restartOnExternalChanges="true" />
    <section name="episerver.search" type="EPiServer.Search.Configuration.SearchSection, EPiServer.Search.Cms.AspNet" />
  </configSections>
  <appSettings>
    <add key="ClientSettingsProvider.ServiceUri" value="" />
  </appSettings>
  <connectionStrings>
    <add name="EPiServerDB" connectionString="Data Source=(localdb)\MSSQLLocalDB;Database=dbSearchIndexingServiceTest;Integrated Security=true;MultipleActiveResultSets=True" providerName="System.Data.SqlClient" />
  </connectionStrings>
  <episerver.search.indexingservice>
    <clients>
      <add name="accesskey1" description="local" readonly="false" allowLocal="true" ipAddress="172.17.0.0/16,10.1.74.0/24" />
      <add name="accesskey2" description="remote" readonly="false" allowLocal="true" />
    </clients>
    <namedIndexes defaultIndex="default">
      <indexes>
        <add name="default" directoryPath="/tmp/testindex" readonly="false" />
        <add name="testindex2" directoryPath="/tmp/testindex2" readonly="false" />
        <add name="testindex3" directoryPath="/tmp/testindex3" readonly="false" />
        <add name="otherlanguage1" directoryPath="/tmp/otherlang1" readonly="false" />
        <add name="otherlanguage2" directoryPath="/tmp/otherlang2" readonly="false" />
        <add name="otherlanguage3" directoryPath="/tmp/otherlang3" readonly="true" />
      </indexes>
    </namedIndexes>
  </episerver.search.indexingservice>
  <system.web>
    <membership defaultProvider="ClientAuthenticationMembershipProvider">
      <providers>
        <add name="ClientAuthenticationMembershipProvider" type="System.Web.ClientServices.Providers.ClientFormsAuthenticationMembershipProvider, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" serviceUri="" />
      </providers>
    </membership>
    <roleManager defaultProvider="ClientRoleProvider" enabled="true">
      <providers>
        <add name="ClientRoleProvider" type="System.Web.ClientServices.Providers.ClientRoleProvider, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" serviceUri="" cacheTimeout="86400" />
      </providers>
    </roleManager>
    <caching>
      <outputCacheSettings>
        <outputCacheProfiles>
          <add name="ClientResourceCache" enabled="true" duration="3600" varyByParam="*" varyByContentEncoding="gzip;deflate" />
        </outputCacheProfiles>
      </outputCacheSettings>
    </caching>
    <httpRuntime requestValidationMode="2.0" />
  </system.web>
  <system.serviceModel>
    <behaviors>
      <endpointBehaviors>
        <behavior name="webHttp">
          <webHttp />
        </behavior>
      </endpointBehaviors>
      <serviceBehaviors>
        <behavior name="credentialConfig">
          <serviceCredentials>
            <clientCertificate>
              <authentication certificateValidationMode="PeerTrust" />
            </clientCertificate>
          </serviceCredentials>
        </behavior>
        <behavior name="IndexingServiceBehavior">
          <!-- WARNING: Setting includeExceptionDetailInFaults = "True" could result in leaking secured server information to the client.-->
          <!-- Please set this to false when deploying -->
          <serviceDebug includeExceptionDetailInFaults="True" httpHelpPageEnabled="True" />
        </behavior>
        <behavior name="DebugServiceBehaviour">
          <serviceDebug includeExceptionDetailInFaults="true" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <services>
      <service name="EPiServer.Search.IndexingService.IndexingService" behaviorConfiguration="IndexingServiceBehavior">
        <endpoint address="" binding="webHttpBinding" contract="EPiServer.Search.IndexingService.IIndexingService">
        </endpoint>
        <host>
          <baseAddresses>
            <add baseAddress="http://localhost:8072/IndexingService/" />
          </baseAddresses>
        </host>
      </service>
    </services>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true" />
  </system.serviceModel>
  <episerver.framework createDatabaseSchema="true" updateDatabaseSchema="true">
    <scanAssembly forceBinFolderScan="true" />
    <virtualRoles replacePrincipal="true">
      <providers>
        <add name="Administrators" type="EPiServer.Security.WindowsAdministratorsRole, EPiServer.Framework" />
        <add name="Everyone" type="EPiServer.Security.EveryoneRole, EPiServer.Framework" />
        <add name="Authenticated" type="EPiServer.Security.AuthenticatedRole, EPiServer.Framework" />
        <add name="Anonymous" type="EPiServer.Security.AnonymousRole, EPiServer.Framework" />
      </providers>
    </virtualRoles>
    <geolocation>
      <providers />
    </geolocation>
    <virtualPathProviders>
      <clear />
    </virtualPathProviders>
  </episerver.framework>
  <episerver.search active="true">
    <namedIndexingServices defaultService="mockupService">
      <services>
        <!--<add name="{serviceName}" baseUri="{indexingServiceBaseUri}" accessKey="{accessKey}"/>-->
        <add name="deniedService" baseUri="http://localhost:8072/IndexingService" accessKey="faulty" />
        <add name="mockupService" baseUri="http://localhost:8072/IndexingService" accessKey="accesskey1" />
      </services>
    </namedIndexingServices>
    <searchResultFilter defaultInclude="true">
      <providers />
    </searchResultFilter>
  </episerver.search>
  <location path="modulesbin">
    <system.web>
      <authorization>
        <deny users="*" />
      </authorization>
    </system.web>
  </location>
  <startup>
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.5" />
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.6.1" />
  </startup>
</configuration>